# JSBSim XML Generator for RC UAV

[![License: CC BY-NC-SA 4.0](https://img.shields.io/badge/Code-CC%20BY--NC--SA%204.0-lightgrey.svg)](https://creativecommons.org/licenses/by-nc-sa/4.0/)
[![Documentation: All Rights Reserved](https://img.shields.io/badge/Documentation-All%20Rights%20Reserved-red.svg)](LICENSE)
[![Non-Commercial](https://img.shields.io/badge/Use-Non--Commercial%20Only-orange.svg)](LICENSE)
[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![JSBSim 1.1.0+](https://img.shields.io/badge/JSBSim-1.1.0+-green.svg)](http://jsbsim.sourceforge.net/)

RCæ©Ÿä½“ã‹ã‚‰JSBSimç”¨XMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚**2ã¤ã®å…¥åŠ›æ–¹å¼**ã‚’ã‚µãƒãƒ¼ãƒˆ:

1. **Excelâ†’JSBSimå¤‰æ›**: Excelãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§æ©Ÿä½“ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å…¥åŠ›
2. **FMSâ†’JSBSimå¤‰æ›**: Flying Model Simulator (.par) ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å¤‰æ›

## ç‰¹å¾´

### å…±é€šæ©Ÿèƒ½
- âœ… **è‡ªå‹•å˜ä½å¤‰æ›**: mm/g/degree â†’ m/kg/radç­‰ã€JSBSimæ¨™æº–å˜ä½ç³»ã¸è‡ªå‹•å¤‰æ›
- âœ… **å…¸å‹çš„ãªç©ºåŠ›ä¿‚æ•°**: å°å‹å›ºå®šç¿¼æ©Ÿã®æ¨™æº–çš„ãªå€¤ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæä¾›
- âœ… **å‹•çš„å®‰å®šæ€§å¯¾å¿œ**: Cmq, CLq, CLadotç­‰ã‚’ã‚µãƒãƒ¼ãƒˆ
- âœ… **JSBSimçµ±åˆæ¤œè¨¼æ¸ˆã¿**: ãƒˆãƒªãƒ åæŸãƒ»10ç§’é–“å®‰å®šé£›è¡Œã‚’ç¢ºèª

### Excelå¤‰æ› (æ¨å¥¨: æ–°è¦æ©Ÿä½“ä½œæˆæ™‚)
- âœ… **ç›´æ„Ÿçš„ãªå…¥åŠ›**: Excelãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§æ©Ÿä½“ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å…¥åŠ›
- âœ… **ã‚¬ã‚¤ãƒ‰ä»˜ã**: å„ã‚»ãƒ« ã«å…¥åŠ›ã‚¬ã‚¤ãƒ‰ã¨å…¸å‹å€¤ã‚’è¨˜è¼‰

### FMSå¤‰æ› (Legacy: æ—¢å­˜FMSãƒ‡ãƒ¼ã‚¿ç§»æ¤æ™‚)
- âœ… **FMS .parãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œ**: Flying Model Simulatorå½¢å¼ã®æ©Ÿä½“ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›
- âœ… **3æ®µéšãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³**: ãƒ‘ãƒ¼ã‚¹ â†’ å¾®ä¿‚æ•°è¨ˆç®— â†’ XMLç”Ÿæˆ
- âœ… **Evidence Levelè¨˜éŒ²**: ãƒ‡ãƒ¼ã‚¿ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«ã‚’è‡ªå‹•è¨˜éŒ² (L1/L2/L3/L6)

## âš ï¸ é‡è¦: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã«ã¤ã„ã¦

**ã‚µãƒ³ãƒ—ãƒ«æ©Ÿä½“ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯å‚è€ƒå€¤ã§ã™**:

- **Evidence Level**: L2 (ç†è«–å€¤/æ–‡çŒ®å€¤)
- **æƒ…å ±æº**: èˆªç©ºå·¥å­¦æ–‡çŒ®ãƒ»å°å‹å›ºå®šç¿¼æ©Ÿã®å…¸å‹å€¤
- **âš ï¸ é£›è¡Œè©¦é¨“æœªå®Ÿæ–½**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯é£›è¡Œè©¦é¨“ã«ã‚ˆã‚‹æ¤œè¨¼ã‚’å—ã‘ã¦ã„ã¾ã›ã‚“

**ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å¿…ãš**:
1. è‡ªåˆ†ã®æ©Ÿä½“ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ç½®ãæ›ãˆã¦ãã ã•ã„
2. é£›è¡Œè©¦é¨“ã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´ã‚’è¡Œã£ã¦ãã ã•ã„
3. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´ã«ã¯PARAMETER_TUNING_GUIDE.mdã‚’å‚ç…§ã—ã¦ãã ã•ã„

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### å¿…è¦ãªç’°å¢ƒ

- Python 3.8ä»¥ä¸Š
- JSBSim 1.1.0ä»¥ä¸Š
- FlightGearï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€å¯è¦–åŒ–ã«ä½¿ç”¨ï¼‰

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/[username]/jsbsim-xml-generator.git
cd jsbsim-xml-generator

# ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt

# ç’°å¢ƒè¨­å®šï¼ˆåˆå›ã®ã¿ï¼‰
python setup.py
```

**setup.pyã®æ©Ÿèƒ½**:
- âœ… è‡ªå‹•ç’°å¢ƒæ¤œå‡ºï¼ˆOS, Python, FlightGearï¼‰
- âœ… è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆï¼ˆconfig.yamlï¼‰
- âœ… å¿…è¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆï¼ˆoutput/, logs/ ç­‰ï¼‰

è©³ç´°ã¯ [config/README.md](config/README.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### ä½¿ç”¨æ–¹æ³•

ã“ã®ãƒ„ãƒ¼ãƒ«ã¯**2ã¤ã®å…¥åŠ›æ–¹å¼**ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚ç”¨é€”ã«å¿œã˜ã¦é¸æŠã—ã¦ãã ã•ã„ã€‚

---

## æ–¹å¼1: Excelâ†’JSBSimå¤‰æ› (æ¨å¥¨: æ–°è¦æ©Ÿä½“ä½œæˆæ™‚)

### 1. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ã‚³ãƒ”ãƒ¼

```bash
cp templates/Aircraft_Input_Template.xlsx my_aircraft.xlsx
```

### 2. æ©Ÿä½“ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å…¥åŠ›

Excelã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€ä»¥ä¸‹ã®ã‚·ãƒ¼ãƒˆã«æ©Ÿä½“ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨˜å…¥:

- **T_01_Basic_Info**: æ©Ÿä½“åã€è³ªé‡ã€ç¿¼é¢ç©ã€ç¿¼å¹…
- **T_02_Mass_Balance**: é‡å¿ƒä½ç½®ã€æ…£æ€§ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ
- **T_03_Propulsion**: ãƒ¢ãƒ¼ã‚¿ãƒ¼ã€ãƒ—ãƒ­ãƒšãƒ©ã€ãƒãƒƒãƒ†ãƒªãƒ¼
- **T_04_Control**: æ“ç¸¦é¢ï¼ˆã‚¨ãƒ«ãƒ­ãƒ³ã€ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ã€ãƒ©ãƒ€ãƒ¼ï¼‰

### 3. JSBSim XMLã‚’ç”Ÿæˆ

```bash
python src/excel_to_jsbsim/generate_jsbsim_from_gsheet.py --input my_aircraft.xlsx --output aircraft/MyAircraft/
```

### 4. JSBSimã§å‹•ä½œç¢ºèª

```python
import jsbsim

fdm = jsbsim.FGFDMExec('.')
fdm.load_model('MyAircraft')
fdm.run_ic()

print("Aircraft loaded successfully!")
```

---

## æ–¹å¼2: FMSâ†’JSBSimå¤‰æ› (Legacy: æ—¢å­˜FMSãƒ‡ãƒ¼ã‚¿ç§»æ¤æ™‚)

Flying Model Simulator (.par) å½¢å¼ã®æ©Ÿä½“ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã¯ã“ã®æ–¹å¼ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

### 1. FMS .parãƒ•ã‚¡ã‚¤ãƒ«ã‚’æº–å‚™

```bash
# æ—¢å­˜ã®.parãƒ•ã‚¡ã‚¤ãƒ«ã‚’ examples/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®
# ã¾ãŸã¯ä»»æ„ã®ãƒ‘ã‚¹ã‚’æŒ‡å®š
```

### 2. å¤‰æ›ã‚’å®Ÿè¡Œ

```bash
python src/fms_to_jsbsim/run_full_pipeline.py examples/my_aircraft.par output/MyAircraft_FMS
```

**å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«**:
- `output/MyAircraft_FMS/MyAircraft_FMS.xml` - JSBSim XML
- `output/MyAircraft_FMS/parsed_data.json` - ãƒ‘ãƒ¼ã‚¹æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿
- `output/MyAircraft_FMS/derived_parameters.json` - è¨ˆç®—æ¸ˆã¿å¾®ä¿‚æ•°
- `output/MyAircraft_FMS/*.txt` - å¤‰æ›ãƒ¬ãƒãƒ¼ãƒˆ

### 3. JSBSimç”¨ã«ã‚³ãƒ”ãƒ¼

```bash
mkdir -p aircraft/MyAircraft_FMS
cp output/MyAircraft_FMS/MyAircraft_FMS.xml aircraft/MyAircraft_FMS/
```

### 4. JSBSimã§å‹•ä½œç¢ºèª

```bash
python tests/test_jsbsim_load.py MyAircraft_FMS
```

---

### ã‚µãƒ³ãƒ—ãƒ«æ©Ÿä½“

#### Excelå¤‰æ›ã‚µãƒ³ãƒ—ãƒ«
`examples/ExampleAircraft_Excel/` ã«200gç´šRC UAVã®ã‚µãƒ³ãƒ—ãƒ«ãŒã‚ã‚Šã¾ã™:

```bash
python tests/test_jsbsim_load.py ExampleAircraft_Excel
```

è©³ç´°ã¯[examples/README.md](examples/README.md)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ãƒ†ã‚¹ãƒˆ

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¯**10ç¨®é¡ã®ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ**ãŒå«ã¾ã‚Œã¦ã„ã¾ã™:

### åŸºæœ¬ãƒ†ã‚¹ãƒˆ
- **test_jsbsim_load.py**: JSBSim XMLèª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆï¼ˆä¸¡æ–¹å¼å¯¾å¿œï¼‰
- **test_unit_conversion.py**: å˜ä½å¤‰æ›æ­£ç¢ºæ€§ãƒ†ã‚¹ãƒˆï¼ˆ27ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ï¼‰

### Excelå¤‰æ›ãƒ†ã‚¹ãƒˆ (8 tests)
- **test_xml_generation.py**: Excel â†’ XMLç”Ÿæˆãƒ†ã‚¹ãƒˆ
- **test_e2e_flight.py**: E2Eãƒ•ãƒ©ã‚¤ãƒˆãƒ†ã‚¹ãƒˆ (Excel â†’ XML â†’ Flight)
- **test_e2e.py**: ãƒ¬ã‚¬ã‚·ãƒ¼E2Eãƒ†ã‚¹ãƒˆ
- **test_trim_manual.py**: æ‰‹å‹•ãƒˆãƒªãƒ æ¢ç´¢ï¼ˆExternal Reactionså¯¾å¿œï¼‰
- **test_trim_stability.py**: ãƒˆãƒªãƒ ãƒ»å®‰å®šæ€§ãƒ†ã‚¹ãƒˆï¼ˆTraditional Engineç”¨ï¼‰
- **test_trim_diagnostic.py**: ãƒˆãƒªãƒ è¨ºæ–­ãƒ„ãƒ¼ãƒ«

**Test Coverage**: 100% (8/8 critical tests implemented)

è©³ç´°ã¯[tests/README.md](tests/README.md)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘
- [ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½¿ç”¨æ–¹æ³•](templates/README.md)
- [ã‚µãƒ³ãƒ—ãƒ«æ©Ÿä½“](examples/README.md)
- [ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰](docs/user_guide/)

### æŠ€è¡“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [æŠ€è¡“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](docs/technical/)

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
jsbsim-xml-generator/
â”œâ”€â”€ README.md                    â† æœ¬ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ LICENSE                      â† ãƒ©ã‚¤ã‚»ãƒ³ã‚¹
â”œâ”€â”€ requirements.txt             â† ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆ2ã¤ã®å…¥åŠ›æ–¹å¼å¯¾å¿œï¼‰
â”œâ”€â”€ setup.py                     â† ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆåˆå›å®Ÿè¡Œï¼‰
â”œâ”€â”€ config.yaml                  â† ãƒ¦ãƒ¼ã‚¶ãƒ¼ç’°å¢ƒè¨­å®šï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
â”œâ”€â”€ config/                      â† è¨­å®šç®¡ç†
â”‚   â”œâ”€â”€ config.default.yaml      â† ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ README.md                â† è¨­å®šã‚¬ã‚¤ãƒ‰
â”‚   â”œâ”€â”€ examples/                â† ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ¥è¨­å®šä¾‹
â”‚   â”œâ”€â”€ excel_to_jsbsim/         â† Excelå¤‰æ›è¨­å®šï¼ˆç©ºï¼‰
â”‚   â””â”€â”€ fms_to_jsbsim/           â† FMSå¤‰æ›è¨­å®š
â”‚       â””â”€â”€ aerodynamic_assumptions.yaml  â† ç©ºåŠ›ä¿‚æ•°æ¨å®šè¨­å®š
â”œâ”€â”€ src/                         â† Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ excel_to_jsbsim/         â† Excelâ†’JSBSimå¤‰æ›
â”‚   â”‚   â”œâ”€â”€ generate_jsbsim_from_gsheet.py  â† ãƒ¡ã‚¤ãƒ³ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”‚   â”œâ”€â”€ config_manager.py    â† è¨­å®šç®¡ç†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”‚   â”œâ”€â”€ unit_conversion.py   â† å˜ä½å¤‰æ›ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”‚   â””â”€â”€ set_default_values.py â† ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤è¨­å®š
â”‚   â””â”€â”€ fms_to_jsbsim/           â† FMSâ†’JSBSimå¤‰æ›
â”‚       â”œâ”€â”€ run_full_pipeline.py â† ãƒ•ãƒ«ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ
â”‚       â”œâ”€â”€ parse_par_file.py    â† .parãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ãƒ¼ã‚µãƒ¼
â”‚       â”œâ”€â”€ calculate_derivatives.py  â† ç©ºåŠ›å¾®ä¿‚æ•°è¨ˆç®—
â”‚       â”œâ”€â”€ generate_xml.py      â† XMLç”Ÿæˆ
â”‚       â””â”€â”€ jsbsim_trim_wrapper.py   â† ãƒˆãƒªãƒ è¨ˆç®—æ”¯æ´
â”œâ”€â”€ templates/                   â† å…¥åŠ›ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”‚   â””â”€â”€ Aircraft_Input_Template.xlsx  â† Excelå…¥åŠ›ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”œâ”€â”€ examples/                    â† ã‚µãƒ³ãƒ—ãƒ«æ©Ÿä½“
â”‚   â””â”€â”€ ExampleAircraft_Excel/   â† Excelå¤‰æ›ã‚µãƒ³ãƒ—ãƒ«ï¼ˆ200gç´šRC UAVï¼‰
â”œâ”€â”€ aircraft/                    â† ç”Ÿæˆã•ã‚ŒãŸJSBSim XMLãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ output/                      â† FMSå¤‰æ›å‡ºåŠ›ï¼ˆä¸­é–“ãƒ•ã‚¡ã‚¤ãƒ«å«ã‚€ï¼‰
â”œâ”€â”€ engines/                     â† ã‚¨ãƒ³ã‚¸ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆç©ºï¼‰
â”œâ”€â”€ tests/                       â† ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ test_jsbsim_load.py      â† åŸºæœ¬ãƒ†ã‚¹ãƒˆï¼ˆä¸¡æ–¹å¼å…±é€šï¼‰
â”‚   â”œâ”€â”€ test_unit_conversion.py  â† å˜ä½å¤‰æ›ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ excel_to_jsbsim/         â† Excelå¤‰æ›ãƒ†ã‚¹ãƒˆï¼ˆç§»è¡Œäºˆå®šï¼‰
â”‚   â””â”€â”€ fms_to_jsbsim/           â† FMSå¤‰æ›ãƒ†ã‚¹ãƒˆï¼ˆã‚µãƒ³ãƒ—ãƒ«ãªã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æä¾› .par ãƒ•ã‚¡ã‚¤ãƒ«ã§ä½¿ç”¨å¯èƒ½ï¼‰
â””â”€â”€ docs/                        â† ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
    â”œâ”€â”€ user_guide/              â† ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰
    â”œâ”€â”€ technical/               â† æŠ€è¡“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
    â””â”€â”€ development/             â† é–‹ç™ºè€…å‘ã‘
```

## å‹•ä½œç¢ºèªç’°å¢ƒ

| é …ç›® | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |
|------|-----------|
| Python | 3.8ä»¥ä¸Š |
| JSBSim | 1.1.0ä»¥ä¸Š |
| openpyxl | 3.0.0ä»¥ä¸Š |
| pandas | 1.3.0ä»¥ä¸Š |
| numpy | 1.21.0ä»¥ä¸Š |
| scipy | 1.7.0ä»¥ä¸Š |

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯**äºŒé‡ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æ§‹é€ **ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ï¼š

### ğŸ“„ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ»è¨˜äº‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
**Copyright Â© 2025 Yaaasoh. All Rights Reserved.**

æœ¬READMEå«ã‚€ã™ã¹ã¦ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ`docs/`, `README.md`ç­‰ï¼‰ã¯ã€æ—¥æœ¬ã®è‘—ä½œæ¨©æ³•ã«ã‚ˆã‚Šä¿è­·ã•ã‚Œã¦ã„ã¾ã™ã€‚

- âŒ å•†ç”¨åˆ©ç”¨ç¦æ­¢
- âŒ ç„¡æ–­è»¢è¼‰ç¦æ­¢
- âŒ æ”¹å¤‰ç¦æ­¢
- â„¹ï¸ é©åˆ‡ãªå¼•ç”¨ã®ã¿å¯èƒ½

### ğŸ’» ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãƒ»ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
**Licensed under CC BY-NC-SA 4.0**

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãƒ»ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆ`src/`, `scripts/`ç­‰ï¼‰ã¯ã€CC BY-NC-SA 4.0 ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚

- âœ… éå•†ç”¨åˆ©ç”¨å¯èƒ½
- âœ… æ”¹å¤‰å¯èƒ½ï¼ˆåŒä¸€ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ç¶™æ‰¿å¿…é ˆï¼‰
- âœ… ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆè¡¨ç¤ºå¿…é ˆ
- âŒ å•†ç”¨åˆ©ç”¨ç¦æ­¢

è©³ç´°: https://creativecommons.org/licenses/by-nc-sa/4.0/

### ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

| ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ | äº’æ›æ€§ |
|-----------|-----------|--------|
| openpyxl | MIT License | âœ… Compatible |
| pandas | BSD 3-Clause License | âœ… Compatible |
| numpy | BSD License | âœ… Compatible |
| scipy | BSD License | âœ… Compatible |
| JSBSim | LGPL 2.1+ | âœ… Compatible* |

**\*JSBSimäº’æ›æ€§æ³¨è¨˜**: JSBSimï¼ˆLGPL 2.1+ï¼‰ã¯å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦å‹•çš„ãƒªãƒ³ã‚¯ã§ä½¿ç”¨ã—ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ JSBSim ã‚’åˆ¥é€”ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€LGPLæ¡é …ã«å¾“ã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ä»¥ä¸‹ã®å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿ã‚’å‚ç…§ã—ã¦ã„ã¾ã™:

- **JSBSimå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ** (LGPL 2.1+)
  - ä½¿ç”¨å½¢æ…‹: XMLãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä»•æ§˜ã®å‚ç…§

- **èˆªç©ºå·¥å­¦æ–‡çŒ®**: å…¬é–‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ç©ºåŠ›ä¿‚æ•°ç†è«–å€¤
  - ä½¿ç”¨å½¢æ…‹: å…¸å‹çš„ãªå°å‹å›ºå®šç¿¼æ©Ÿã®å€¤ã‚’å‚è€ƒ

è©³ç´°ã¯[LICENSE](LICENSE)ãŠã‚ˆã³[PROJECT_RULES.md](PROJECT_RULES.md)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### JSBSimãŒãƒ¢ãƒ‡ãƒ«ã‚’èª­ã¿è¾¼ã‚ãªã„

**ç—‡çŠ¶**: `Could not open file: MyAircraft.xml`

**è§£æ±ºç­–**:
1. ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒ`aircraft/`ã®è¦ªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ã‚‹ã‹ç¢ºèª
2. `aircraft/MyAircraft/MyAircraft.xml`ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª

### ãƒˆãƒªãƒ ãŒåæŸã—ãªã„ï¼ˆManual Trim Searchä½¿ç”¨æ™‚ï¼‰

**ç—‡çŠ¶**: `test_trim_manual.py`ã§ã‚‚wdot/qdotãŒç›®æ¨™å€¤ã«åæŸã—ãªã„

**ä¸»è¦åŸå› **:

#### 1. ç©ºåŠ›ä¿‚æ•°ã®å¦¥å½“æ€§ç¢ºèªï¼ˆæœ€é‡è¦ãƒ»Priority 1ï¼‰

è‡ªå‹•è¨ˆç®—ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ç”Ÿæˆå€¤ãŒ**éåº¦ã«å¼·ã„å®‰å®šæ€§**ã‚’æŒã¤å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

**è¨ºæ–­æ–¹æ³•**:
```bash
python tests/test_trim_diagnostic.py MyAircraft
```

**å…¸å‹çš„ãªå•é¡Œ**:
- **CL0ãŒé«˜ã™ãã‚‹**: ä¸€èˆ¬çš„ãªç¯„å›² 0.0-0.1ï¼ˆç¿¼å‹ã«ã‚ˆã‚‹ï¼‰
- **CmalphaãŒå¼·ã™ãã‚‹**: ä¸€èˆ¬çš„ãªç¯„å›² -0.3 to -0.8ï¼ˆç¸¦å®‰å®šæ€§ï¼‰
- **Cm_deãŒå¼·ã™ãã‚‹**: ä¸€èˆ¬çš„ãªç¯„å›² -0.3 to -0.6ï¼ˆæ˜‡é™èˆµåŠ¹ãï¼‰
- **CLalphaãŒé«˜ã™ãã‚‹**: ä¸€èˆ¬çš„ãªç¯„å›² 4.0-5.5ï¼ˆæšåŠ›å‚¾æ–œï¼‰

**å¯¾ç­–**:
èˆªç©ºå·¥å­¦ã®æ¨™æº–çš„ãªç¯„å›²ã¨æ¯”è¼ƒã—ã€éåº¦ã«å¤§ããªå€¤ãŒãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚
ç‰¹ã«Cmalphaï¼ˆç¸¦å®‰å®šå¾®ä¿‚æ•°ï¼‰ãŒå¼·ã™ãã‚‹ã¨ã€trimæ™‚ã«pitch momentãŒé‡£ã‚Šåˆã„ã¾ã›ã‚“ã€‚

#### 2. ãƒ†ã‚¹ãƒˆæ™‚ã®æ¨åŠ›è¨­å®šï¼ˆPriority 2ï¼‰

**å•é¡Œ**: åˆæœŸå€¤throttle 50-100%ã‹ã‚‰ãƒ†ã‚¹ãƒˆ â†’ æ¨åŠ›æ”¯æ´é£›è¡Œãƒ¢ãƒ¼ãƒ‰

**å¯¾ç­–**: ãƒ†ã‚¹ãƒˆæ™‚ã«çµã£ãŸå€¤ï¼ˆ10-30%ï¼‰ã‹ã‚‰é–‹å§‹
```bash
# test_trim_manual.py ã¯è‡ªå‹•çš„ã«10-50%ã®ç¯„å›²ã§ãƒ†ã‚¹ãƒˆ
python tests/test_trim_manual.py MyAircraft 15
```

**æ¨åŠ›ã¨æšåŠ›ã®ãƒãƒ©ãƒ³ã‚¹** (JSBSimã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä¸Š):
- æ¨åŠ›/é‡é‡æ¯”ãŒ0.05-0.15ç¨‹åº¦ã§ç´”ç²‹ãªç©ºåŠ›é£›è¡Œãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦å‹•ä½œ
- T/W > 0.5ã®å ´åˆã§ã‚‚ã€ãƒ†ã‚¹ãƒˆæ™‚ã«é©åˆ‡ãªæ¨åŠ›ç¯„å›²ï¼ˆ10-30%ï¼‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§æ­£ã—ã„trim pointã‚’æ¢ç´¢å¯èƒ½
- **æ³¨**: å®Ÿæ©Ÿã§ã¯é¢¨ãƒ»ä¹±æµç­‰ã®å½±éŸ¿ãŒã‚ã‚‹ãŸã‚ã€ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœã¨å®Ÿæ©Ÿã®æŒ™å‹•ã¯ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™

**æ³¨**: é«˜ã„T/Wæ¯”ï¼ˆ>0.5ï¼‰è‡ªä½“ã¯å•é¡Œã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚é‡è¦ãªã®ã¯**ãƒ†ã‚¹ãƒˆæ™‚ã«é©åˆ‡ãªæ¨åŠ›ç¯„å›²ã‚’ä½¿ç”¨**ã™ã‚‹ã“ã¨ã§ã™ã€‚

### âš ï¸ JSBSim Built-in TrimãŒå¤±æ•—ã™ã‚‹ï¼ˆExternal Reactionsä½¿ç”¨æ™‚ï¼‰

**ç—‡çŠ¶**: `fdm.do_trim(2)` ãŒ `Trim Failed` ã‚’è¿”ã™

**åŸå› **:
- ã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ç”Ÿæˆã•ã‚ŒãŸXMLã¯ **External Reactions** æ–¹å¼ã‚’ä½¿ç”¨
- JSBSim built-in trim (`FGTrim`) ã¯ External Reactions ã¨**äº’æ›æ€§ãŒã‚ã‚Šã¾ã›ã‚“**

**ã“ã‚Œã¯æ—¢çŸ¥ã®åˆ¶ç´„ã§ã‚ã‚Šã€ãƒã‚°ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚**

**è§£æ±ºç­–**: Manual Trim Searchï¼ˆæ‰‹å‹•ãƒˆãƒªãƒ æ¢ç´¢ï¼‰ã‚’ä½¿ç”¨

```python
# tests/test_trim_manual.py ã‚’ä½¿ç”¨
python tests/test_trim_manual.py MyAircraft 15

# ã¾ãŸã¯ scipy.optimize ã§æ‰‹å‹•å®Ÿè£…
from scipy.optimize import fsolve

def trim_cost(x, fdm, target_speed):
    elevator, throttle = x
    fdm['fcs/elevator-cmd-norm'] = elevator
    fdm['fcs/throttle-cmd-norm'] = throttle
    fdm.run()

    wdot = fdm['accelerations/wdot-ft_sec2']
    qdot = fdm['accelerations/qdot-rad_sec2']

    return [wdot, qdot]

# ãƒˆãƒªãƒ æ¢ç´¢
result = fsolve(trim_cost, [0.0, 0.5], args=(fdm, 15.0))
```

**èƒŒæ™¯**:
- JSBSim trim algorithmã¯ traditional engine/propeller ã‚’æƒ³å®š
- External Reactionsã®æ¨åŠ›ãƒ¢ãƒ‡ãƒ«ã§trim solverãŒæ··ä¹±
- 6è»¸å®Œå…¨ãƒ¢ãƒ‡ãƒ«å®Ÿç¾ã®ãŸã‚External Reactionsæ¡ç”¨

è©³ç´°ã¯[examples/README.md](examples/README.md)ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ­“è¿ï¼Issueå ±å‘Šã‚„ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯GitHubãƒªãƒã‚¸ãƒˆãƒªã¾ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚

## è¬è¾

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ä»¥ä¸‹ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™:

- **JSBSim**: ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹é£›è¡ŒåŠ›å­¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼
- **FlightGear**: ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ•ãƒ©ã‚¤ãƒˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

## å‚è€ƒè³‡æ–™

- [JSBSimå…¬å¼ã‚µã‚¤ãƒˆ](http://jsbsim.sourceforge.net/)
- [JSBSim Reference Manual](http://jsbsim.sourceforge.net/JSBSimReferenceManual.pdf)

---

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0
**æœ€çµ‚æ›´æ–°**: 2025-10-20
**å…¥åŠ›æ–¹å¼**: Excelâ†’JSBSim + FMSâ†’JSBSim
**å¯¾å¿œJSBSim**: 1.1.0ä»¥ä¸Š

---

**Â© 2025 Yaaasoh. All Rights Reserved.**

æœ¬READMEåŠã³ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®è‘—ä½œæ¨©ã¯Yaaasohã«å¸°å±ã—ã¾ã™ã€‚ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯CC BY-NC-SA 4.0ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚è©³ç´°ã¯[LICENSE](LICENSE)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
